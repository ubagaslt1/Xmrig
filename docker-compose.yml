version: '3.8'
services:
  xmrig:
    build: .
    container_name: umbrel-app-xmrig-gui
    restart: unless-stopped
    ports:
      - "${APP_XMRIG_GUI_PORT:-3000}:3000"
    volumes:
      - xmrig-config:/app/config
      - xmrig-logs:/app/logs
    environment:
      - POOL_URL=${POOL_URL:-pool.supportxmr.com:443}
      - WALLET_ADDRESS=${WALLET_ADDRESS}
      - POOL_PASS=${POOL_PASS:-x}
      - DONATE_LEVEL=${DONATE_LEVEL:-1}
      - THREADS=${THREADS}
      - MAX_CPU_USAGE=${MAX_CPU_USAGE:-75}
      - BACKGROUND_MINING=${BACKGROUND_MINING:-true}
    cap_add:
      - SYS_ADMIN
      - SYS_NICE
    # Use specific cores (optional)
    # cpuset: "0-9"
    deploy:
      resources:
        limits:
          cpus: '${THREADS:-10}'
        reservations:
          cpus: '${THREADS:-10}'

volumes:
  xmrig-config:
  xmrig-logs:
